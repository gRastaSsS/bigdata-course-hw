/usr/local/Cellar/apache-spark/3.1.2/bin/spark-submit --master local[2] --deploy-mode client --class bd.consumer.BDConsumer --name RunBDConsumer --packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.1.2,org.apache.spark:spark-streaming-kafka-0-10_2.12:3.1.2 --driver-memory 1024M --driver-cores 1 --executor-memory 1G /Users/vladislav.gerasimov/IdeaProjects/bd-task-2/consumer/target/consumer-1.0-SNAPSHOT.jar
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.spark.unsafe.Platform (file:/usr/local/Cellar/apache-spark/3.1.2/libexec/jars/spark-unsafe_2.12-3.1.2.jar) to constructor java.nio.DirectByteBuffer(long,int)
WARNING: Please consider reporting this to the maintainers of org.apache.spark.unsafe.Platform
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
:: loading settings :: url = jar:file:/usr/local/Cellar/apache-spark/3.1.2/libexec/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /Users/vladislav.gerasimov/.ivy2/cache
The jars for the packages stored in: /Users/vladislav.gerasimov/.ivy2/jars
org.apache.spark#spark-sql-kafka-0-10_2.12 added as a dependency
org.apache.spark#spark-streaming-kafka-0-10_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-7633d3e3-491d-4c25-bbe8-345b42bcee63;1.0
	confs: [default]
	found org.apache.spark#spark-sql-kafka-0-10_2.12;3.1.2 in local-m2-cache
	found org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.1.2 in local-m2-cache
	found org.apache.kafka#kafka-clients;2.6.0 in local-m2-cache
	found com.github.luben#zstd-jni;1.4.8-1 in local-m2-cache
	found org.lz4#lz4-java;1.7.1 in local-m2-cache
	found org.xerial.snappy#snappy-java;1.1.8.2 in local-m2-cache
	found org.slf4j#slf4j-api;1.7.30 in local-m2-cache
	found org.spark-project.spark#unused;1.0.0 in local-m2-cache
	found org.apache.commons#commons-pool2;2.6.2 in local-m2-cache
	found org.apache.spark#spark-streaming-kafka-0-10_2.12;3.1.2 in local-m2-cache
:: resolution report :: resolve 371ms :: artifacts dl 22ms
	:: modules in use:
	com.github.luben#zstd-jni;1.4.8-1 from local-m2-cache in [default]
	org.apache.commons#commons-pool2;2.6.2 from local-m2-cache in [default]
	org.apache.kafka#kafka-clients;2.6.0 from local-m2-cache in [default]
	org.apache.spark#spark-sql-kafka-0-10_2.12;3.1.2 from local-m2-cache in [default]
	org.apache.spark#spark-streaming-kafka-0-10_2.12;3.1.2 from local-m2-cache in [default]
	org.apache.spark#spark-token-provider-kafka-0-10_2.12;3.1.2 from local-m2-cache in [default]
	org.lz4#lz4-java;1.7.1 from local-m2-cache in [default]
	org.slf4j#slf4j-api;1.7.30 from local-m2-cache in [default]
	org.spark-project.spark#unused;1.0.0 from local-m2-cache in [default]
	org.xerial.snappy#snappy-java;1.1.8.2 from local-m2-cache in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   10  |   0   |   0   |   0   ||   10  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-7633d3e3-491d-4c25-bbe8-345b42bcee63
	confs: [default]
	0 artifacts copied, 10 already retrieved (0kB/19ms)
21/06/02 19:11:10 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
21/06/02 19:11:10 INFO SparkContext: Running Spark version 3.1.2
21/06/02 19:11:11 INFO ResourceUtils: ==============================================================
21/06/02 19:11:11 INFO ResourceUtils: No custom resources configured for spark.driver.
21/06/02 19:11:11 INFO ResourceUtils: ==============================================================
21/06/02 19:11:11 INFO SparkContext: Submitted application: bd_task_2_app
21/06/02 19:11:11 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
21/06/02 19:11:11 INFO ResourceProfile: Limiting resource is cpu
21/06/02 19:11:11 INFO ResourceProfileManager: Added ResourceProfile id: 0
21/06/02 19:11:11 INFO SecurityManager: Changing view acls to: vladislav.gerasimov
21/06/02 19:11:11 INFO SecurityManager: Changing modify acls to: vladislav.gerasimov
21/06/02 19:11:11 INFO SecurityManager: Changing view acls groups to:
21/06/02 19:11:11 INFO SecurityManager: Changing modify acls groups to:
21/06/02 19:11:11 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(vladislav.gerasimov); groups with view permissions: Set(); users  with modify permissions: Set(vladislav.gerasimov); groups with modify permissions: Set()
21/06/02 19:11:11 INFO Utils: Successfully started service 'sparkDriver' on port 64918.
21/06/02 19:11:11 INFO SparkEnv: Registering MapOutputTracker
21/06/02 19:11:11 INFO SparkEnv: Registering BlockManagerMaster
21/06/02 19:11:11 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
21/06/02 19:11:11 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
21/06/02 19:11:11 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
21/06/02 19:11:11 INFO DiskBlockManager: Created local directory at /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/blockmgr-83a8fdb9-568f-4306-9586-7cfc50433cdd
21/06/02 19:11:11 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
21/06/02 19:11:11 INFO SparkEnv: Registering OutputCommitCoordinator
21/06/02 19:11:11 INFO Utils: Successfully started service 'SparkUI' on port 4040.
21/06/02 19:11:11 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://192.168.1.59:4040
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.1.2.jar at spark://192.168.1.59:64918/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.1.2.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.apache.spark_spark-streaming-kafka-0-10_2.12-3.1.2.jar at spark://192.168.1.59:64918/jars/org.apache.spark_spark-streaming-kafka-0-10_2.12-3.1.2.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.1.2.jar at spark://192.168.1.59:64918/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.1.2.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.apache.kafka_kafka-clients-2.6.0.jar at spark://192.168.1.59:64918/jars/org.apache.kafka_kafka-clients-2.6.0.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.apache.commons_commons-pool2-2.6.2.jar at spark://192.168.1.59:64918/jars/org.apache.commons_commons-pool2-2.6.2.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://192.168.1.59:64918/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/com.github.luben_zstd-jni-1.4.8-1.jar at spark://192.168.1.59:64918/jars/com.github.luben_zstd-jni-1.4.8-1.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.lz4_lz4-java-1.7.1.jar at spark://192.168.1.59:64918/jars/org.lz4_lz4-java-1.7.1.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.xerial.snappy_snappy-java-1.1.8.2.jar at spark://192.168.1.59:64918/jars/org.xerial.snappy_snappy-java-1.1.8.2.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:///Users/vladislav.gerasimov/.ivy2/jars/org.slf4j_slf4j-api-1.7.30.jar at spark://192.168.1.59:64918/jars/org.slf4j_slf4j-api-1.7.30.jar with timestamp 1622650270957
21/06/02 19:11:11 INFO SparkContext: Added JAR file:/Users/vladislav.gerasimov/IdeaProjects/bd-task-2/consumer/target/consumer-1.0-SNAPSHOT.jar at spark://192.168.1.59:64918/jars/consumer-1.0-SNAPSHOT.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Executor: Starting executor ID driver on host 192.168.1.59
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.lz4_lz4-java-1.7.1.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO TransportClientFactory: Successfully created connection to /192.168.1.59:64918 after 40 ms (0 ms spent in bootstraps)
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.lz4_lz4-java-1.7.1.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp14688989095861748761.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.lz4_lz4-java-1.7.1.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.apache.spark_spark-streaming-kafka-0-10_2.12-3.1.2.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.apache.spark_spark-streaming-kafka-0-10_2.12-3.1.2.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp2911801725634005194.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.apache.spark_spark-streaming-kafka-0-10_2.12-3.1.2.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/consumer-1.0-SNAPSHOT.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/consumer-1.0-SNAPSHOT.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp13064053151008452035.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/consumer-1.0-SNAPSHOT.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.1.2.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.apache.spark_spark-sql-kafka-0-10_2.12-3.1.2.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp7432500202439709560.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.apache.spark_spark-sql-kafka-0-10_2.12-3.1.2.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.apache.commons_commons-pool2-2.6.2.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.apache.commons_commons-pool2-2.6.2.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp15212756211324775216.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.apache.commons_commons-pool2-2.6.2.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.xerial.snappy_snappy-java-1.1.8.2.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.xerial.snappy_snappy-java-1.1.8.2.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp1486661033040064643.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.xerial.snappy_snappy-java-1.1.8.2.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/com.github.luben_zstd-jni-1.4.8-1.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/com.github.luben_zstd-jni-1.4.8-1.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp9376253568459061453.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/com.github.luben_zstd-jni-1.4.8-1.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.apache.kafka_kafka-clients-2.6.0.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.apache.kafka_kafka-clients-2.6.0.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp14763564884775242893.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.apache.kafka_kafka-clients-2.6.0.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.slf4j_slf4j-api-1.7.30.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.slf4j_slf4j-api-1.7.30.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp16816792859117317096.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.slf4j_slf4j-api-1.7.30.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.spark-project.spark_unused-1.0.0.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp5233410020285440581.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.spark-project.spark_unused-1.0.0.jar to class loader
21/06/02 19:11:12 INFO Executor: Fetching spark://192.168.1.59:64918/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.1.2.jar with timestamp 1622650270957
21/06/02 19:11:12 INFO Utils: Fetching spark://192.168.1.59:64918/jars/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.1.2.jar to /private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/fetchFileTemp13995115665281796712.tmp
21/06/02 19:11:12 INFO Executor: Adding file:/private/var/folders/f9/l5wx23z53qs8nq6qtjt408b80000gn/T/spark-56c46b6a-be4b-432e-a629-e7a09d2033a5/userFiles-ebc1e258-cd72-40c0-8567-91285415b046/org.apache.spark_spark-token-provider-kafka-0-10_2.12-3.1.2.jar to class loader
21/06/02 19:11:12 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 64920.
21/06/02 19:11:12 INFO NettyBlockTransferService: Server created on 192.168.1.59:64920
21/06/02 19:11:12 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
21/06/02 19:11:12 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 192.168.1.59, 64920, None)
21/06/02 19:11:12 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.1.59:64920 with 434.4 MiB RAM, BlockManagerId(driver, 192.168.1.59, 64920, None)
21/06/02 19:11:12 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 192.168.1.59, 64920, None)
21/06/02 19:11:12 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 192.168.1.59, 64920, None)
21/06/02 19:11:14 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
